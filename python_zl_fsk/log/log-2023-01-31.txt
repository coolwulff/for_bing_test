2023-01-31 23:52:39,053 - ERROR - MainThread -fsk_hive_connect.py - execute_sql - 76 - TExecuteStatementResp(status=TStatus(statusCode=3, infoMessages=["*org.apache.hive.service.cli.HiveSQLException:Error while processing statement: FAILED: Execution Error, return code 30041 from org.apache.hadoop.hive.ql.exec.spark.SparkTask. Failed to create Spark client for Spark session 8cf2da5b-656a-40e1-88a4-7cb3798c6fc1: java.util.concurrent.TimeoutException: Client '8cf2da5b-656a-40e1-88a4-7cb3798c6fc1' timed out waiting for connection from the Remote Spark Driver:17:16", 'org.apache.hive.service.cli.operation.Operation:toSQLException:Operation.java:335', 'org.apache.hive.service.cli.operation.SQLOperation:runQuery:SQLOperation.java:258', 'org.apache.hive.service.cli.operation.SQLOperation:runInternal:SQLOperation.java:293', 'org.apache.hive.service.cli.operation.Operation:run:Operation.java:266', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatementInternal:HiveSessionImpl.java:504', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatement:HiveSessionImpl.java:479', 'org.apache.hive.service.cli.CLIService:executeStatement:CLIService.java:270', 'org.apache.hive.service.cli.thrift.ThriftCLIService:ExecuteStatement:ThriftCLIService.java:508', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1437', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1422', 'org.apache.thrift.ProcessFunction:process:ProcessFunction.java:39', 'org.apache.thrift.TBaseProcessor:process:TBaseProcessor.java:39', 'org.apache.hive.service.auth.TSetIpAddressProcessor:process:TSetIpAddressProcessor.java:56', 'org.apache.thrift.server.TThreadPoolServer$WorkerProcess:run:TThreadPoolServer.java:286', 'java.util.concurrent.ThreadPoolExecutor:runWorker:ThreadPoolExecutor.java:1149', 'java.util.concurrent.ThreadPoolExecutor$Worker:run:ThreadPoolExecutor.java:624', 'java.lang.Thread:run:Thread.java:748', "*org.apache.hadoop.hive.ql.metadata.HiveException:Failed to create Spark client for Spark session 8cf2da5b-656a-40e1-88a4-7cb3798c6fc1: java.util.concurrent.TimeoutException: Client '8cf2da5b-656a-40e1-88a4-7cb3798c6fc1' timed out waiting for connection from the Remote Spark Driver:28:12", 'org.apache.hadoop.hive.ql.exec.spark.session.SparkSessionImpl:getHiveException:SparkSessionImpl.java:296', 'org.apache.hadoop.hive.ql.exec.spark.session.SparkSessionImpl:open:SparkSessionImpl.java:140', 'org.apache.hadoop.hive.ql.exec.spark.session.SparkSessionManagerImpl:getSession:SparkSessionManagerImpl.java:131', 'org.apache.hadoop.hive.ql.exec.spark.SparkUtilities:getSparkSession:SparkUtilities.java:128', 'org.apache.hadoop.hive.ql.exec.spark.SparkTask:execute:SparkTask.java:122', 'org.apache.hadoop.hive.ql.exec.Task:executeTask:Task.java:199', 'org.apache.hadoop.hive.ql.exec.TaskRunner:runSequential:TaskRunner.java:97', 'org.apache.hadoop.hive.ql.Driver:launchTask:Driver.java:2250', 'org.apache.hadoop.hive.ql.Driver:execute:Driver.java:1893', 'org.apache.hadoop.hive.ql.Driver:runInternal:Driver.java:1613', 'org.apache.hadoop.hive.ql.Driver:run:Driver.java:1332', 'org.apache.hadoop.hive.ql.Driver:run:Driver.java:1327', 'org.apache.hive.service.cli.operation.SQLOperation:runQuery:SQLOperation.java:256', "*java.lang.RuntimeException:Timed out waiting for Remote Spark Driver to connect to HiveServer2.\nPossible reasons include network issues, errors in remote driver, cluster has no available resources, etc.\nPlease check YARN or Spark driver's logs for further information.:32:5", 'org.apache.hive.spark.client.SparkClientImpl:<init>:SparkClientImpl.java:124', 'org.apache.hive.spark.client.SparkClientFactory:createClient:SparkClientFactory.java:90', 'org.apache.hadoop.hive.ql.exec.spark.RemoteHiveSparkClient:createRemoteClient:RemoteHiveSparkClient.java:104', 'org.apache.hadoop.hive.ql.exec.spark.RemoteHiveSparkClient:<init>:RemoteHiveSparkClient.java:100', 'org.apache.hadoop.hive.ql.exec.spark.HiveSparkClientFactory:createHiveSparkClient:HiveSparkClientFactory.java:76', 'org.apache.hadoop.hive.ql.exec.spark.session.SparkSessionImpl:open:SparkSessionImpl.java:135', "*java.util.concurrent.ExecutionException:java.util.concurrent.TimeoutException: Client '8cf2da5b-656a-40e1-88a4-7cb3798c6fc1' timed out waiting for connection from the Remote Spark Driver:33:1", 'io.netty.util.concurrent.AbstractFuture:get:AbstractFuture.java:41', 'org.apache.hive.spark.client.SparkClientImpl:<init>:SparkClientImpl.java:103', "*java.util.concurrent.TimeoutException:Client '8cf2da5b-656a-40e1-88a4-7cb3798c6fc1' timed out waiting for connection from the Remote Spark Driver:8:6", 'org.apache.hive.spark.client.rpc.RpcServer$2:run:RpcServer.java:178', 'io.netty.util.concurrent.PromiseTask$RunnableAdapter:call:PromiseTask.java:38', 'io.netty.util.concurrent.ScheduledFutureTask:run:ScheduledFutureTask.java:120', 'io.netty.util.concurrent.AbstractEventExecutor:safeExecute:AbstractEventExecutor.java:163', 'io.netty.util.concurrent.SingleThreadEventExecutor:runAllTasks:SingleThreadEventExecutor.java:403', 'io.netty.channel.nio.NioEventLoop:run:NioEventLoop.java:463', 'io.netty.util.concurrent.SingleThreadEventExecutor$5:run:SingleThreadEventExecutor.java:858'], sqlState='42000', errorCode=30041, errorMessage="Error while processing statement: FAILED: Execution Error, return code 30041 from org.apache.hadoop.hive.ql.exec.spark.SparkTask. Failed to create Spark client for Spark session 8cf2da5b-656a-40e1-88a4-7cb3798c6fc1: java.util.concurrent.TimeoutException: Client '8cf2da5b-656a-40e1-88a4-7cb3798c6fc1' timed out waiting for connection from the Remote Spark Driver"), operationHandle=None)
